<dom-module id="my-rest">
    <style>
        :host {
            display: block;
        }
        
        @media (max-width: 600px) {
            h1.paper-font-display1 {
                font-size: 24px;
            }
        }
    </style>
    <template>

        <iron-ajax id="ironAjaxId" params="{{params}}" on-response="handleResponse" handle-as="json" last-response="{{_ajaxResponse}}">
        </iron-ajax>


        <h1 class="paper-font-display1"><span>{{url}}</span></h1>
        <span class="paper-font-body2">Update text to change the url.</span>
        <!-- Listens for "input" event and sets greeting to <input>.value -->
        <input class="paper-font-body2" value="{{url::input}}">

        <button on-click="handleClick">Kick Me</button>
        </br>
        <span>{{ajaxResponse}}</span>

    </template>

    <script>
        (function () {
            Polymer({
                is: 'my-rest',

                properties: {
                    url: {
                        type: String,
                        value: 'http://jsonplaceholder.typicode.com/posts',
                        notify: true
                    },
                    _ajaxResponse: {
                        observer: '_ajaxResponseChanged'
                    },
                    ajaxResponse: {
                        type: String,
                        notify: true
                    }
                },
                handleClick: function () {
                    this.$.ironAjaxId.url = this.url;
                    this.ajaxResponse = "";
                    this.$.ironAjaxId.generateRequest();

                },
                _ajaxResponseChanged: function (newValue, oldValue) {
                    if (newValue !== null) {
                        this.ajaxResponse = JSON.stringify(newValue);
                    }
                },
                handleResponse: function (request) {
                    console.log("my-rest response recieved");
                }
            });
        })();
    </script>

</dom-module>